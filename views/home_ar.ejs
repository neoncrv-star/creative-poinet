<%- include('partials/header') %>

<!-- Page Specific CSS -->
<link rel="stylesheet" href="/css/hero.css">
<link rel="stylesheet" href="/css/journey.css">
<link rel="stylesheet" href="/css/services.css">
<link rel="stylesheet" href="/css/portfolio-slider.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

<style>
    :root {
        --service-overlay-opacity: <%= (globalSeo && globalSeo.serviceOverlayOpacity !== undefined) ? globalSeo.serviceOverlayOpacity : 0.8 %>;
        --service-image-brightness: <%= (globalSeo && globalSeo.serviceImageBrightness !== undefined) ? globalSeo.serviceImageBrightness : 0.5 %>;
        --slider-height: <%= (globalSeo && globalSeo.sliderHeight) ? globalSeo.sliderHeight : '500px' %>;
    }
    
    .portfolio-swiper {
        height: var(--slider-height) !important;
    }
    
    .project-card {
        height: 100% !important;
    }

    .project-card img, .project-card video {
        height: 100% !important;
        object-fit: cover !important;
    }

    .panel-overlay {
        background: linear-gradient(to right, 
            rgba(0,0,0, var(--service-overlay-opacity)) 0%, 
            rgba(0,0,0, 0.2) 50%, 
            rgba(0,0,0, var(--service-overlay-opacity)) 100%) !important;
    }
    
    .parallax-img {
        filter: brightness(var(--service-image-brightness)) contrast(1.1) !important;
    }
</style>

<main>

    <!-- =========================
         Sticky Mask Hero Section
    ========================== -->
    <section class="hero-sticky-section">
        <div class="hero-sticky-wrapper">
            
            <!-- The Mask/Reveal Container -->
            <div class="hero-mask-container">
                <div class="hero-video-wrapper">
                    <% 
                    let heroVideoSrc = seo && seo.heroVideoUrl ? seo.heroVideoUrl : 'https://cdn.coverr.co/videos/coverr-red-smoke-5374/1080p.mp4';
                    let isYoutube = heroVideoSrc.includes('youtube.com') || heroVideoSrc.includes('youtu.be');
                    if (isYoutube) {
                        let videoId = '';
                        if (heroVideoSrc.includes('youtu.be/')) {
                            videoId = heroVideoSrc.split('youtu.be/')[1].split('?')[0];
                        } else if (heroVideoSrc.includes('v=')) {
                            videoId = heroVideoSrc.split('v=')[1].split('&')[0];
                        } else if (heroVideoSrc.includes('embed/')) {
                            videoId = heroVideoSrc.split('embed/')[1].split('?')[0];
                        }
                        heroVideoSrc = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&loop=1&playlist=${videoId}&controls=0&showinfo=0&rel=0&enablejsapi=1&modestbranding=1&iv_load_policy=3&origin=${process.env.APP_URL || ''}`;
                    }
                    %>
                    
                    <% if (isYoutube) { %>
                        <iframe class="hero-video" 
                            src="<%= heroVideoSrc %>" 
                            title="Hero Video" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                            style="pointer-events: none;">
                        </iframe>
                    <% } else { %>
                        <video class="hero-video" playsinline muted loop autoplay preload="metadata" poster="/210.png">
                            <source src="<%= heroVideoSrc %>" type="video/mp4">
                        </video>
                    <% } %>
                    <div class="hero-video-overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 2;"></div>
                </div>
                
                <!-- Content revealed inside the video -->
                <div class="hero-content-overlay">
                    <h1 class="hero-title">كل إبداع يبدأ<br>بنقطة</h1>
                    <p class="hero-subtitle">
                        هذا الشعار لا يختصر رؤيتنا فحسب، بل يعكس منهجنا
                        الاستراتيجي في بناء علامات لا تُنسى.
                    </p>
                    <a href="#journey" class="hero-btn">اكتشف الرحلة</a>
                </div>
            </div>

            <!-- Initial Elements (Visible before scroll) -->
            <div class="hero-initial-point">
                <div class="dots-wrapper">
                    <div class="point-dot-white"></div>
                    <div class="point-dot-red"></div>
                </div>
                <div class="hero-initial-text">نقطة البداية</div>
            </div>

            <div class="scroll-mouse-icon">
                <div class="mouse-shape">
                    <div class="mouse-wheel"></div>
                </div>
                <span class="scroll-text">تصفح</span>
            </div>
            
        </div>
    </section>

    <!-- Journey Section -->
    <section id="journey" class="journey-scroll-section">
        <div class="journey-container" style="text-align: center;">
            <p class="journey-eyebrow" style="text-align: center;">شركة وكالة نقطة إبداعية</p>
            <div class="journey-text-content" style="text-align: center;">
                <span class="journey-line">وكالة إبداعية وتسويقية متكاملة الخدمات</span>
                <span class="journey-line">ترتكز على فكرة واضحة قبل البدء بأي تنفيذ</span>
                <span class="journey-line">في عالم مزدحم بالضجيج البصري والإعلاني</span>
                <span class="journey-line">لا نبدأ بالزخرفة</span>
                <span class="journey-line">بل نبدأ بقرار استراتيجي ذكي وموحد</span>
                <span class="journey-line">من هذه النقطة، نعيد الإبداع إلى جوهره الحقيقي</span>
                <span class="journey-line">هوية بصرية راسخة</span>
                <span class="journey-line">حلول تصميم احترافية</span>
                <span class="journey-line">وتجهيزات عالية الجودة</span>
            </div>
        </div>
    </section>

    <!-- =========================
         Cinematic Horizontal Services Section
    ========================== -->
    <section id="services" class="services-horizontal-section">
        <div class="services-horizontal-wrapper">
            <div class="services-panel-container">
                <!-- Intro Panel -->
                <div class="service-panel intro-panel">
                    <div class="panel-content">
                        <div class="intro-text-wrap">
                            <span class="services-counter">(0<%= services && services.length > 0 ? services.length : 3 %>)</span>
                            <h2 class="services-section-title">الخدمات</h2>
                            <p class="services-desc">حلول إبداعية تنطلق من نقطة واحدة... وتتحول إلى نظام مؤثر</p>
                        </div>
                        <div class="scroll-indicator">
                            <div class="arrow-left">
                                <i class="ri-arrow-left-line"></i>
                            </div>
                            <span>اسحب للاكتشاف</span>
                        </div>
                    </div>
                </div>

                <% if (services && services.length > 0) { %>
                    <% services.forEach((service, index) => { %>
                        <div class="service-panel" id="service-<%= index + 1 %>">
                            <div class="panel-bg-wrapper">
                                <% if (service.image) { %>
                                    <img src="<%= service.image %>" alt="<%= service.title_ar %>" class="parallax-img" loading="lazy" decoding="async" onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1600607686527-6fb886090705?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80';">
                                <% } else { %>
                                    <img src="https://images.unsplash.com/photo-1600607686527-6fb886090705?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Service Placeholder" class="parallax-img" loading="lazy" decoding="async" onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80';">
                                <% } %>
                                <div class="panel-overlay"></div>
                            </div>
                            <div class="panel-content">
                                <div class="panel-header">
                                    <span class="panel-number">0<%= index + 1 %></span>
                                    <h2 class="panel-title"><%= service.title_ar || service.title_en || service.title || 'خدمة' %></h2>
                                </div>
                                <div class="panel-body">
                                    <p class="panel-desc"><%= service.description_ar || service.description_en || '' %></p>
                                    <div class="panel-tags">
                                        <span class="tag"><%= service.tag1_ar || 'استراتيجية' %></span>
                                        <span class="tag"><%= service.tag2_ar || 'تصميم' %></span>
                                        <span class="tag"><%= service.tag3_ar || 'تنفيذ' %></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <!-- Fallback Static Content -->
                    <div class="service-panel" id="service-1">
                        <div class="panel-bg-wrapper">
                            <img src="https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="الهوية البصرية" class="parallax-img">
                            <div class="panel-overlay"></div>
                        </div>
                        <div class="panel-content">
                            <div class="panel-header">
                                <span class="panel-number">01</span>
                                <h2 class="panel-title">الهوية البصرية</h2>
                            </div>
                            <div class="panel-body">
                                <p class="panel-desc">نحول الرسائل التسويقية إلى تصاميم ذكية تخدم الهدف.</p>
                                <div class="panel-tags">
                                    <span class="tag">شعار</span>
                                    <span class="tag">هوية بصرية</span>
                                    <span class="tag">أدلة استخدام</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="service-panel" id="service-2">
                        <div class="panel-bg-wrapper">
                            <img src="https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="التسويق الرقمي" class="parallax-img">
                            <div class="panel-overlay"></div>
                        </div>
                        <div class="panel-content">
                            <div class="panel-header">
                                <span class="panel-number">02</span>
                                <h2 class="panel-title">التسويق الرقمي</h2>
                            </div>
                            <div class="panel-body">
                                <p class="panel-desc">استراتيجيات تسويقية متكاملة للوصول إلى جمهورك المستهدف.</p>
                                <div class="panel-tags">
                                    <span class="tag">SEO</span>
                                    <span class="tag">إعلانات</span>
                                    <span class="tag">تحليل بيانات</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="service-panel" id="service-3">
                        <div class="panel-bg-wrapper">
                            <img src="https://images.unsplash.com/photo-1498050108023-c5249f4df085?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="تطوير المواقع" class="parallax-img">
                            <div class="panel-overlay"></div>
                        </div>
                        <div class="panel-content">
                            <div class="panel-header">
                                <span class="panel-number">03</span>
                                <h2 class="panel-title">تطوير المواقع</h2>
                            </div>
                            <div class="panel-body">
                                <p class="panel-desc">نصمم التجربة قبل أن نصمم الواجهة بأحدث التقنيات.</p>
                                <div class="panel-tags">
                                    <span class="tag">UI/UX</span>
                                    <span class="tag">Full Stack</span>
                                    <span class="tag">صيانة</span>
                                </div>
                            </div>
                        </div>
                    </div>
                <% } %>
            </div>
        </div>
    </section>

    <!-- Portfolio Slider Section -->
    <section id="portfolio" class="portfolio-section">
        <div class="container">
            <div class="portfolio-header" data-gsap="fade-up" style="text-align: center;">
                <h2 class="portfolio-title">آخر المشاريع</h2>
                <p style="text-align: center;">نحول الأفكار إلى واقع ملموس... شاهد أعمالنا</p>
            </div>

            <div class="portfolio-container" data-gsap="fade-up">
                <button class="portfolio-nav-btn prev-btn">
                    <i class="ri-arrow-right-line"></i>
                </button>
                <button class="portfolio-nav-btn next-btn">
                    <i class="ri-arrow-left-line"></i>
                </button>

                <div class="swiper portfolio-swiper">
                    <div class="swiper-wrapper">
                        <% if (projects && projects.length > 0) { %>
                            <% projects.forEach(project => { %>
                                <div class="swiper-slide">
                                    <div class="project-card">
                                        <% if (project.image && (project.image.endsWith('.mp4') || project.image.endsWith('.webm'))) { %>
                                            <video src="<%= project.image %>" muted loop playsinline autoplay></video>
                                        <% } else if (project.image) { %>
                                            <img src="<%= project.image %>" alt="<%= project.title_ar || project.title %>">
                                        <% } else { %>
                                            <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Project Placeholder">
                                        <% } %>
                                        
                                        <div class="project-overlay">
                                            <div class="project-info">
                                                <h3><%= project.title_ar || project.title %></h3>
                                                <p><%= project.description_ar || project.description %></p>
                                                <a href="<%= project.externalLink || '/portfolio/' + project.id %>" class="project-link" <%= project.externalLink ? 'target="_blank"' : '' %>>
                                                    <span>عرض المشروع</span>
                                                    <i class="ri-arrow-left-line"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            <% }); %>
                        <% } else { %>
                            <!-- Fallback static projects -->
                            <% for(let i=1; i<=6; i++) { %>
                                <div class="swiper-slide">
                                    <div class="project-card">
                                        <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Project <%= i %>">
                                        <div class="project-overlay">
                                            <div class="project-info">
                                                <h3>مشروع إبداعي <%= i %></h3>
                                                <p>وصف مختصر للمشروع وكيف ساعدنا العميل في تحقيق أهدافه.</p>
                                                <a href="#" class="project-link">
                                                    <span>عرض المشروع</span>
                                                    <i class="ri-arrow-left-line"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            <% } %>
                        <% } %>
                    </div>
                    <!-- Add Pagination -->
                    <div class="swiper-pagination"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Partners Section -->
    <section id="partners" class="partners-section">
        <div class="container">
            <div class="partners-header" data-gsap="fade-up">
                <h2 class="partners-title">نحن فخورون بعملنا، وأكثر فخراً بالشراكات التي تعاونا معهم.</h2>
            </div>
            <div class="partners-grid">
                <% if (partners && partners.length > 0) { %>
                    <% partners.forEach(partner => { %>
                        <div class="partner-item" data-gsap="fade-up">
                            <img src="<%= partner.logo %>" alt="<%= partner.name %>" title="<%= partner.name %>">
                        </div>
                    <% }) %>
                <% } else { %>
                    <!-- Fallback static logos if no partners in DB -->
                    <div class="partner-item" data-gsap="fade-up"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Saudi_Aramco_logo.svg/1200px-Saudi_Aramco_logo.svg.png" alt="Saudi Aramco"></div>
                    <div class="partner-item" data-gsap="fade-up"><img src="https://upload.wikimedia.org/wikipedia/ar/thumb/8/82/Misk_Foundation_logo.svg/1200px-Misk_Foundation_logo.svg.png" alt="Misk"></div>
                    <div class="partner-item" data-gsap="fade-up"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/ROSHN_Logo.svg/1200px-ROSHN_Logo.svg.png" alt="ROSHN"></div>
                    <div class="partner-item" data-gsap="fade-up"><img src="https://upload.wikimedia.org/wikipedia/ar/thumb/e/e0/Diriyah_Gate_Development_Authority_logo.svg/1200px-Diriyah_Gate_Development_Authority_logo.svg.png" alt="DGDA"></div>
                <% } %>
            </div>
        </div>
    </section>

    <!-- Blog Section -->
    <section id="blog" class="blog-home-section">
        <div class="container">
            <div class="section-header" data-gsap="fade-up" style="text-align: center; margin-bottom: 3rem;">
                <h2 class="section-title" style="font-size: 2.5rem; margin-bottom: 1rem;">آخر المقالات</h2>
                <p style="color: #888; font-size: 1.1rem;">أفكار ورؤى في عالم التصميم والتكنولوجيا</p>
            </div>
            
            <div class="blog-grid">
                <% if (posts && posts.length > 0) { %>
                    <% posts.forEach(post => { %>
                        <article class="blog-card" data-gsap="fade-up">
                            <% if (post.image) { %>
                                <div class="blog-image">
                                    <img src="<%= post.image %>" alt="<%= post.title %>">
                                </div>
                            <% } %>
                            <div class="blog-content">
                                <span class="blog-date"><%= post.date %></span>
                                <h3><%= post.title %></h3>
                                <p class="blog-excerpt"><%= post.excerpt %></p>
                                <a href="/blog/<%= post.id %>" class="read-more">
                                    <span>اقرأ المزيد</span>
                                    <i class="ri-arrow-left-line"></i>
                                </a>
                            </div>
                        </article>
                    <% }) %>
                <% } else { %>
                    <div style="grid-column: 1/-1; text-align: center; padding: 50px; background: #0a0a0a; border-radius: 20px; border: 1px solid #1a1a1a;">
                        <p style="color: #666;">لا توجد مقالات حالياً.</p>
                    </div>
                <% } %>
            </div>
            
            <div class="view-all-container" data-gsap="fade-up">
                <a href="/blog" class="view-all-btn">مشاهدة جميع المقالات</a>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section">
        <div class="container">
            <div class="contact-grid">
                <div class="contact-info" data-gsap="fade-left">
                    <h2 class="contact-title">لنبدأ رحلة<br>إبداعية جديدة</h2>
                    <p class="contact-subtitle">نحن هنا لنسمع أفكارك ونحولها إلى استراتيجية بصرية مؤثرة. تواصل معنا اليوم.</p>
                    
                    <div class="contact-details">
                        <div class="contact-item">
                            <i class="ri-phone-line"></i>
                            <div>
                                <span>اتصل بنا</span>
                                <p dir="ltr">+966 56 839 49 45</p>
                            </div>
                        </div>
                        <div class="contact-item">
                            <i class="ri-mail-line"></i>
                            <div>
                                <span>البريد الإلكتروني</span>
                                <p>info@cpoint-sa.com</p>
                            </div>
                        </div>
                        <div class="contact-item">
                            <i class="ri-map-pin-line"></i>
                            <div>
                                <span>الموقع</span>
                                <p>المملكة العربية السعودية، الرياض</p>
                            </div>
                        </div>
                    </div>

                    <div class="social-links">
                        <a href="#"><i class="ri-instagram-line"></i></a>
                        <a href="#"><i class="ri-twitter-x-line"></i></a>
                        <a href="#"><i class="ri-linkedin-box-line"></i></a>
                    </div>
                </div>

                <div class="contact-form-wrapper" data-gsap="fade-right">
                    <form action="/contact" method="POST" class="contact-form">
                        <div class="form-group">
                            <input type="text" name="name" placeholder="الاسم الكامل" required>
                        </div>
                        <div class="form-group">
                            <input type="email" name="email" placeholder="البريد الإلكتروني" required>
                        </div>
                        <div class="form-group">
                            <input type="tel" name="phone" placeholder="رقم الجوال">
                        </div>
                        <div class="form-group">
                            <select name="service">
                                <option value="" disabled selected>نوع الخدمة المطلوبة</option>
                                <option value="branding">الهوية البصرية</option>
                                <option value="marketing">التسويق الرقمي</option>
                                <option value="web">تطوير المواقع</option>
                                <option value="other">أخرى</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <textarea name="message" rows="5" placeholder="تفاصيل المشروع" required></textarea>
                        </div>
                        <button type="submit" class="submit-btn">
                            <span>إرسال الطلب</span>
                            <i class="ri-send-plane-fill"></i>
                        </button>
                    </form>
                    
                    <div id="contact-success" style="display: none; margin-top: 20px; padding: 15px; background: #222; border: 1px solid #fff; border-radius: 10px; color: #fff; text-align: center;">
                        <i class="ri-checkbox-circle-line" style="font-size: 1.5rem; vertical-align: middle; margin-left: 10px;"></i>
                        تم إرسال طلبك بنجاح! سنتواصل معك قريباً.
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Check for success/error query params
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('success')) {
            document.getElementById('contact-success').style.display = 'block';
            const contactForm = document.querySelector('.contact-form');
            if (contactForm) contactForm.style.display = 'none';
        }
    </script>

</main>

    <!-- Page Specific Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js" defer></script>
    <script src="/js/hero-animation.js?v=<%= assetVersion %>" defer></script>
    <script src="/js/journey-animation.js?v=<%= assetVersion %>" defer></script>
    <script src="/js/services-animation.js?v=<%= assetVersion %>" defer></script>

    <!-- Slider Config Injection -->
    <script id="slider-config-data" type="application/json">
        <%- JSON.stringify({
            effect: (seo && seo.sliderEffect) ? seo.sliderEffect : "slide",
            autoplay: (seo && seo.sliderAutoplay) ? true : false,
            autoplayDelay: (seo && seo.sliderAutoplayDelay) ? seo.sliderAutoplayDelay : 3000,
            slidesPerView: (seo && seo.sliderSlidesPerView) ? seo.sliderSlidesPerView : 3,
            spaceBetween: (seo && seo.sliderSpaceBetween) ? seo.sliderSpaceBetween : 30
        }) %>
    </script>
    <%- include('partials/footer') %>
