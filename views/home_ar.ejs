<%- include('partials/header') %>

<!-- =========================
     Critical CSS preload
========================== -->
<link rel="preload" href="/css/hero.css?v=<%= assetVersion %>" as="style" onload="this.rel='stylesheet'">
<link rel="preload" href="/css/journey.css?v=<%= assetVersion %>" as="style" onload="this.rel='stylesheet'">
<link rel="preload" href="/css/services.css?v=<%= assetVersion %>" as="style" onload="this.rel='stylesheet'">
<link rel="preload" href="/css/portfolio-slider.css?v=<%= assetVersion %>" as="style" onload="this.rel='stylesheet'">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" as="style" onload="this.rel='stylesheet'">

<noscript>
<link rel="stylesheet" href="/css/hero.css?v=<%= assetVersion %>">
<link rel="stylesheet" href="/css/journey.css?v=<%= assetVersion %>">
<link rel="stylesheet" href="/css/services.css?v=<%= assetVersion %>">
<link rel="stylesheet" href="/css/portfolio-slider.css?v=<%= assetVersion %>">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
</noscript>

<style>
:root{
--service-overlay-opacity:<%= globalSeo?.serviceOverlayOpacity ?? 0.8 %>;
--service-image-brightness:<%= globalSeo?.serviceImageBrightness ?? 0.5 %>;
--slider-height:<%= globalSeo?.sliderHeight ?? '500px' %>;
}

.portfolio-swiper{height:var(--slider-height)!important;}
.project-card{height:100%!important;}
.project-card img,.project-card video{height:100%!important;object-fit:cover!important;}

.panel-overlay{
background:linear-gradient(to right,
rgba(0,0,0,var(--service-overlay-opacity))0%,
rgba(0,0,0,0.2)50%,
rgba(0,0,0,var(--service-overlay-opacity))100%)!important;
}

.parallax-img{
filter:brightness(var(--service-image-brightness))contrast(1.1)!important;
transform:translateZ(0);
will-change:transform;
}
</style>

<main>

<!-- =========================
     HERO
========================== -->
<section class="hero-sticky-section">
<div class="hero-sticky-wrapper">
<div class="hero-mask-container">

<%
let heroVideoSrc = seo?.heroVideoUrl || 'https://cdn.coverr.co/videos/coverr-red-smoke-5374/1080p.mp4';
let isYoutube = /youtube|youtu\.be/.test(heroVideoSrc);
let videoId='';
if(isYoutube){
if(heroVideoSrc.includes('youtu.be/')) videoId=heroVideoSrc.split('youtu.be/')[1].split('?')[0];
else if(heroVideoSrc.includes('v=')) videoId=heroVideoSrc.split('v=')[1].split('&')[0];
heroVideoSrc=`https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&loop=1&playlist=${videoId}&controls=0&rel=0&modestbranding=1`;
}
%>

<div class="hero-video-wrapper">

<% if(isYoutube){ %>
<div class="yt-lite" data-id="<%= videoId %>">
<img src="https://i.ytimg.com/vi/<%= videoId %>/hqdefault.jpg"
alt="Hero video"
width="1920"
height="1080"
loading="eager"
decoding="async">
</div>
<% }else{ %>
<video class="hero-video"
playsinline muted loop autoplay
preload="metadata"
poster="/210.png"
width="1920" height="1080">
<source src="<%= heroVideoSrc %>" type="video/mp4">
</video>
<% } %>

<div class="hero-video-overlay"></div>
</div>

<div class="hero-content-overlay">
<h1 class="hero-title">كل إبداع يبدأ<br>بنقطة</h1>
<p class="hero-subtitle">
هذا الشعار لا يختصر رؤيتنا فحسب، بل يعكس منهجنا الاستراتيجي.
</p>
<a href="#journey" class="hero-btn">اكتشف الرحلة</a>
</div>

</div>
</div>
</section>

<!-- =========================
     Journey
========================== -->
<section id="journey" class="journey-scroll-section">
<div class="journey-container">
<p class="journey-eyebrow">شركة وكالة نقطة إبداعية</p>
<div class="journey-text-content">
<span class="journey-line">وكالة إبداعية وتسويقية متكاملة</span>
<span class="journey-line">ترتكز على فكرة واضحة</span>
<span class="journey-line">نبدأ بقرار استراتيجي</span>
<span class="journey-line">ثم نعيد الإبداع إلى جوهره</span>
</div>
</div>
</section>

<!-- =========================
     SERVICES
========================== -->
<section id="services" class="services-horizontal-section">
<div class="services-horizontal-wrapper">
<div class="services-panel-container">

<div class="service-panel intro-panel">
<div class="panel-content">
<span class="services-counter">(0<%= services?.length ?? 3 %>)</span>
<h2>الخدمات</h2>
</div>
</div>

<% services?.forEach((service,index)=>{ %>
<div class="service-panel">

<div class="panel-bg-wrapper">

<img
src="<%= assetPath(service.image) %>?v=<%= assetVersion %>"
alt="<%= service.title_ar %>"
width="1200"
height="800"
loading="lazy"
decoding="async"
fetchpriority="low"
onerror="this.onerror=null;this.src='/images/fallback.webp';">

<div class="panel-overlay"></div>

</div>
</div>
<% }) %>

</div>
</div>
</section>

<!-- =========================
     Portfolio
========================== -->
<section id="portfolio" class="portfolio-section">
<div class="container">
<div class="swiper portfolio-swiper">
<div class="swiper-wrapper">

<% projects?.forEach(project=>{ %>
<div class="swiper-slide">
<div class="project-card">

<% if(project.image?.match(/\.(mp4|webm)$/)){ %>
<video
src="<%= project.image %>?v=<%= assetVersion %>"
muted loop playsinline autoplay>
</video>
<% }else{ %>
<img
src="<%= project.image %>?v=<%= assetVersion %>"
alt="<%= project.title_ar || project.title %>"
width="1200"
height="800"
loading="lazy"
decoding="async"
onerror="this.src='/images/fallback.webp'">
<% } %>

</div>
</div>
<% }) %>

</div>
</div>
</div>
</section>

</main>

<!-- =========================
     Scripts
========================== -->
<script defer src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script defer src="/js/hero-animation.js?v=<%= assetVersion %>"></script>
<script defer src="/js/journey-animation.js?v=<%= assetVersion %>"></script>
<script defer src="/js/services-animation.js?v=<%= assetVersion %>"></script>

<%- include('partials/footer') %>
