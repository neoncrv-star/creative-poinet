<% const isEn = true; %>
<%- include('partials/header', { isEn: isEn }) %>

<!-- Page Specific CSS (async to reduce render-blocking) -->
<link rel="preload" href="/css/hero.css?v=<%= assetVersion %>" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="/css/journey.css?v=<%= assetVersion %>" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="/css/services.css?v=<%= assetVersion %>" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="/css/portfolio-slider.css?v=<%= assetVersion %>" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="/css/hero.css?v=<%= assetVersion %>">
    <link rel="stylesheet" href="/css/journey.css?v=<%= assetVersion %>">
    <link rel="stylesheet" href="/css/services.css?v=<%= assetVersion %>">
    <link rel="stylesheet" href="/css/portfolio-slider.css?v=<%= assetVersion %>">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
</noscript>

<style>
    :root {
        --service-overlay-opacity: <%= (globalSeo && globalSeo.serviceOverlayOpacity !== undefined) ? globalSeo.serviceOverlayOpacity : 0.8 %>;
        --service-image-brightness: <%= (globalSeo && globalSeo.serviceImageBrightness !== undefined) ? globalSeo.serviceImageBrightness : 0.5 %>;
        --slider-height: <%= (globalSeo && globalSeo.sliderHeight) ? globalSeo.sliderHeight : '500px' %>;
    }
     
    .portfolio-swiper {
        height: var(--slider-height) !important;
    } 
    
    .project-card {
        height: 100% !important;
    }
 
    .project-card img, .project-card video {
        height: 100% !important;
        object-fit: cover !important;
    }

    .panel-overlay {
        background: linear-gradient(to right, 
            rgba(0,0,0, var(--service-overlay-opacity)) 0%, 
            rgba(0,0,0, 0.2) 50%, 
            rgba(0,0,0, var(--service-overlay-opacity)) 100%) !important;
    }
    
    .parallax-img {
        filter: brightness(var(--service-image-brightness)) contrast(1.1) !important;
    }
</style>

<main>
        <!-- =========================
             Sticky Mask Hero Section
        ========================== -->
        <section class="hero-sticky-section">
            <div class="hero-sticky-wrapper">
                
                <!-- The Mask/Reveal Container -->
                <div class="hero-mask-container">
                    <div class="hero-video-wrapper">
                        <% 
                        let heroVideoSrc = seo && seo.heroVideoUrl ? seo.heroVideoUrl : 'https://cdn.coverr.co/videos/coverr-red-smoke-5374/1080p.mp4';
                        let isYoutube = heroVideoSrc.includes('youtube.com') || heroVideoSrc.includes('youtu.be');
                        let videoId = '';
                        if (isYoutube) {
                            if (heroVideoSrc.includes('youtu.be/')) {
                                videoId = heroVideoSrc.split('youtu.be/')[1].split('?')[0];
                            } else if (heroVideoSrc.includes('v=')) {
                                videoId = heroVideoSrc.split('v=')[1].split('&')[0];
                            } else if (heroVideoSrc.includes('embed/')) {
                                videoId = heroVideoSrc.split('embed/')[1].split('?')[0];
                            }
                            heroVideoSrc = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&loop=1&playlist=${videoId}&controls=0&showinfo=0&rel=0&enablejsapi=1&modestbranding=1&iv_load_policy=3&origin=${process.env.APP_URL || ''}`;
                        }
                        %>
                        
                        <% if (isYoutube) { %>
                            <div class="yt-lite" data-id="<%= (typeof videoId !== 'undefined' && videoId) ? videoId : '' %>" style="position:relative;display:block;cursor:pointer;">
                                <div class="lty-playbtn" style="width:68px;height:48px;position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.6);border-radius:14%;"></div>
                                <img src="https://i.ytimg.com/vi/<%= (typeof videoId !== 'undefined' && videoId) ? videoId : '' %>/hqdefault.jpg" alt="Hero Video" loading="lazy" decoding="async" style="width:100%;height:100%;object-fit:cover;">
                            </div>
                        <% } else { %>
                            <video class="hero-video" playsinline muted loop autoplay preload="metadata" poster="/210.png">
                                <source src="<%= heroVideoSrc %>" type="video/mp4">
                            </video>
                        <% } %>
                        <div class="hero-video-overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 2;"></div>
                    </div>
                    
                    <!-- Content revealed inside the video -->
                    <div class="hero-content-overlay">
                        <h1 class="hero-title">Every Creativity Starts <br> With a Point</h1>
                        <p class="hero-subtitle">
                            This slogan goes beyond summarizing our vision-it embodies our practical and strategic mindset at Creative Point.
                        </p>
                        <a href="#journey" class="hero-btn">Explore</a>
                    </div>
                </div>

                <!-- Initial Elements (Visible before scroll) -->
                <div class="hero-initial-point">
                    <div class="dots-wrapper">
                        <div class="point-dot-white"></div>
                        <div class="point-dot-red"></div>
                    </div>
                    <div class="hero-initial-text">The Point</div>
                </div>

                <div class="scroll-mouse-icon">
                    <div class="mouse-shape">
                        <div class="mouse-wheel"></div>
                    </div>
                    <span class="scroll-text">Scroll</span>
                </div>
                
            </div>
        </section>

        <!-- Journey Section -->
        <section id="journey" class="journey-scroll-section">
            <div class="journey-container" style="text-align: center;">
                <p class="journey-eyebrow" style="text-align: center;">Creative Point Agency</p>
                <div class="journey-text-content" style="text-align: center;">
                    <span class="journey-line">A full-service creative and marketing agency</span>
                    <span class="journey-line">Built around one clear idea before any execution begins</span>
                    <span class="journey-line">In a world crowded with visual and advertising noise</span>
                    <span class="journey-line">We don't start with decoration</span>
                    <span class="journey-line">We start with a smart, unified strategic decision</span>
                    <span class="journey-line">From this point, we bring creativity back to its true essence</span>
                    <span class="journey-line">A solid visual identity</span>
                    <span class="journey-line">Professional design solutions</span>
                    <span class="journey-line">And high-quality exhibition and conference setups</span>
                </div>
            </div>
        </section>
        <script>
        (function(){
          const lite = document.querySelector('.yt-lite');
          if (!lite) return;
          const id = lite.getAttribute('data-id');
          function activate(){
            if (lite.dataset.loaded) return;
            lite.dataset.loaded = '1';
            const iframe = document.createElement('iframe');
            iframe.className = 'hero-video';
            iframe.loading = 'lazy';
            iframe.referrerPolicy = 'strict-origin-when-cross-origin';
            iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
            iframe.src = `https://www.youtube.com/embed/${id}?autoplay=1&mute=1&loop=1&playlist=${id}&controls=0&showinfo=0&rel=0&modestbranding=1&iv_load_policy=3`;
            iframe.style.pointerEvents = 'none';
            lite.replaceWith(iframe);
          }
          lite.addEventListener('click', activate, { once: true });
          if ('requestIdleCallback' in window) requestIdleCallback(()=>setTimeout(activate, 2000));
          else window.addEventListener('load', ()=>setTimeout(activate, 2000), { once: true });
        })();
        </script>

        <!-- =========================
             Cinematic Horizontal Services Section
        ========================== -->
        <section id="services" class="services-horizontal-section">
            <div class="services-horizontal-wrapper">
                <div class="services-panel-container">
                    <!-- Intro Panel -->
                    <div class="service-panel intro-panel">
                        <div class="panel-content">
                            <div class="intro-text-wrap">
                                <span class="services-counter">(0<%= services && services.length > 0 ? services.length : 3 %>)</span>
                                <h2 class="services-section-title">Services</h2>
                                <p class="services-desc">Integrated creative solutions starting from a single point... turning into an impactful system</p>
                            </div>
                            <div class="scroll-indicator">
                                <div class="arrow-right">
                                    <i class="ri-arrow-right-line"></i>
                                </div>
                                <span>Scroll to Explore</span>
                            </div>
                        </div>
                    </div>

                    <% if (services && services.length > 0) { %>
                        <% services.forEach((service, index) => { %>
                            <div class="service-panel" id="service-<%= index + 1 %>">
                                <div class="panel-content">
                                    <div class="panel-header">
                                        <span class="panel-number">0<%= index + 1 %></span>
                                        <h2 class="panel-title"><%= service.title_en %></h2>
                                    </div>
                                    <div class="panel-body">
                                        <p class="panel-desc"><%= service.description_en %></p>
                                        <div class="panel-tags">
                                            <span class="tag"><%= service.tag1_en || 'Strategy' %></span>
                                            <span class="tag"><%= service.tag2_en || 'Design' %></span>
                                            <span class="tag"><%= service.tag3_en || 'Execution' %></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel-bg-wrapper">
                                    <% if (service.image) { %>
                                        <img src="<%= assetPath(service.image) %>" alt="<%= service.title_en %>" class="parallax-img" loading="lazy" decoding="async" width="1200" height="800" onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1600607686527-6fb886090705?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80';">
                                    <% } else { %>
                                        <img src="https://images.unsplash.com/photo-1600607686527-6fb886090705?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Service Placeholder" class="parallax-img" loading="lazy" decoding="async" width="1200" height="800" onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80';">
                                    <% } %>
                                    <div class="panel-overlay"></div>
                                </div>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <!-- Fallback Static Content -->
                        <div class="service-panel" id="service-1">
                            <div class="panel-content">
                                <div class="panel-header">
                                    <span class="panel-number">01</span>
                                    <h2 class="panel-title">Visual Identity</h2>
                                </div>
                                <div class="panel-body">
                                    <p class="panel-desc">We turn marketing messages into smart designs that achieve their purpose.</p>
                                    <div class="panel-tags">
                                        <span class="tag">Logo</span>
                                        <span class="tag">Branding</span>
                                        <span class="tag">Guidelines</span>
                                    </div>
                                </div>
                            </div>
                            <div class="panel-bg-wrapper">
                                <img src="https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Visual Identity" class="parallax-img" width="1200" height="800" loading="lazy" decoding="async">
                                <div class="panel-overlay"></div>
                            </div>
                        </div>

                        <div class="service-panel" id="service-2">
                            <div class="panel-content">
                                <div class="panel-header">
                                    <span class="panel-number">02</span>
                                    <h2 class="panel-title">Digital Marketing</h2>
                                </div>
                            </div>
                            <div class="panel-content">
                                <div class="panel-body">
                                    <p class="panel-desc">Integrated marketing strategies to reach your target audience.</p>
                                    <div class="panel-tags">
                                        <span class="tag">SEO</span>
                                        <span class="tag">Ads</span>
                                        <span class="tag">Analytics</span>
                                    </div>
                                </div>
                            </div>
                            <div class="panel-bg-wrapper">
                                <img src="https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Digital Marketing" class="parallax-img" width="1200" height="800" loading="lazy" decoding="async">
                                <div class="panel-overlay"></div>
                            </div>
                        </div>

                        <div class="service-panel" id="service-3">
                            <div class="panel-content">
                                <div class="panel-header">
                                    <span class="panel-number">03</span>
                                    <h2 class="panel-title">Web Development</h2>
                                </div>
                                <div class="panel-body">
                                    <p class="panel-desc">We design the experience before we design the interface with the latest technologies.</p>
                                    <div class="panel-tags">
                                        <span class="tag">UI/UX</span>
                                        <span class="tag">Full Stack</span>
                                        <span class="tag">Maintenance</span>
                                    </div>
                                </div>
                            </div>
                            <div class="panel-bg-wrapper">
                                <img src="https://images.unsplash.com/photo-1498050108023-c5249f4df085?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Web Development" class="parallax-img" width="1200" height="800" loading="lazy" decoding="async">
                                <div class="panel-overlay"></div>
                            </div>
                        </div>
                    <% } %>
                </div>
            </div>
        </section>

        <!-- Portfolio Slider Section -->
        <section id="portfolio" class="portfolio-section">
            <div class="container">
                <div class="portfolio-header" data-gsap="fade-up" style="text-align: center;">
                    <h2 class="portfolio-title">Latest Projects</h2>
                    <p style="text-align: center;">Turning ideas into reality... Explore our work</p>
                </div>

                <div class="portfolio-container" data-gsap="fade-up">
                    <button class="portfolio-nav-btn prev-btn">
                        <i class="ri-arrow-left-line"></i>
                    </button>
                    <button class="portfolio-nav-btn next-btn">
                        <i class="ri-arrow-right-line"></i>
                    </button>

                    <div class="swiper portfolio-swiper">
                        <div class="swiper-wrapper">
                            <% if (projects && projects.length > 0) { %>
                                <% projects.forEach(project => { %>
                                    <div class="swiper-slide">
                                        <div class="project-card">
                                            <% if (project.image && (project.image.endsWith('.mp4') || project.image.endsWith('.webm'))) { %>
                                                <video src="<%= project.image %>" muted loop playsinline></video>
                                            <% } else if (project.image) { %>
                                            <img src="<%= project.image %>" alt="<%= project.title_en || project.title %>" width="1200" height="800" loading="lazy" decoding="async">
                                            <% } else { %>
                                            <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Project Placeholder" width="800" height="600" loading="lazy" decoding="async">
                                            <% } %>
                                            
                                            <div class="project-overlay">
                                                <div class="project-info">
                                                    <h3><%= project.title_en || project.title %></h3>
                                                    <p><%= project.description_en || project.description %></p>
                                                    <a href="<%= project.externalLink || '/portfolio/' + project.id %>" class="project-link" <%= project.externalLink ? 'target="_blank"' : '' %>>
                                                        <span>View Project</span>
                                                        <i class="ri-arrow-right-line"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                <% }); %>
                            <% } else { %>
                                <!-- Fallback static projects -->
                                <% for(let i=1; i<=6; i++) { %>
                                    <div class="swiper-slide">
                                        <div class="project-card">
                                            <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Project <%= i %>">
                                            <div class="project-overlay">
                                                <div class="project-info">
                                                    <h3>Creative Project <%= i %></h3>
                                                    <p>Short description of the project and how we helped the client.</p>
                                                    <a href="#" class="project-link">
                                                        <span>View Project</span>
                                                        <i class="ri-arrow-right-line"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                <% } %>
                            <% } %>
                        </div>
                        <!-- Add Pagination -->
                        <div class="swiper-pagination"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Partners Section -->
        <section id="partners" class="partners-section">
            <div class="container">
                <div class="partners-header" data-gsap="fade-up">
                    <h2 class="partners-title">We take pride in our work and are even more proud of the partnerships we've established.</h2>
                </div>
                <div class="partners-grid">
                    <% if (partners && partners.length > 0) { %>
                        <% partners.forEach(partner => { %>
                            <div class="partner-item" data-gsap="fade-up">
                                <img src="<%= partner.logo %>" alt="<%= partner.name %>" title="<%= partner.name %>">
                            </div>
                        <% }) %>
                    <% } else { %>
                        <!-- Fallback static logos if no partners in DB -->
                        <div class="partner-item" data-gsap="fade-up"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Saudi_Aramco_logo.svg/1200px-Saudi_Aramco_logo.svg.png" alt="Saudi Aramco"></div>
                        <div class="partner-item" data-gsap="fade-up"><img src="https://upload.wikimedia.org/wikipedia/ar/thumb/8/82/Misk_Foundation_logo.svg/1200px-Misk_Foundation_logo.svg.png" alt="Misk"></div>
                        <div class="partner-item" data-gsap="fade-up"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/ROSHN_Logo.svg/1200px-ROSHN_Logo.svg.png" alt="ROSHN"></div>
                        <div class="partner-item" data-gsap="fade-up"><img src="https://upload.wikimedia.org/wikipedia/ar/thumb/e/e0/Diriyah_Gate_Development_Authority_logo.svg/1200px-Diriyah_Gate_Development_Authority_logo.svg.png" alt="DGDA"></div>
                    <% } %>
                </div>
            </div>
        </section>

        <!-- Blog Section -->
        <section id="blog" class="blog-home-section">
            <div class="container">
                <div class="section-header" data-gsap="fade-up" style="text-align: center; margin-bottom: 3rem;">
                    <h2 class="section-title" style="font-size: 2.5rem; margin-bottom: 1rem;">Latest Articles</h2>
                    <p style="color: #888; font-size: 1.1rem;">Insights and thoughts in the world of design and technology</p>
                </div>
                
                <div class="blog-grid">
                    <% if (posts && posts.length > 0) { %>
                        <% posts.forEach(post => { %>
                            <article class="blog-card" data-gsap="fade-up">
                                <% if (post.image) { %>
                                    <div class="blog-image">
                                        <img src="<%= post.image %>" alt="<%= post.title %>">
                                    </div>
                                <% } %>
                                <div class="blog-content">
                                    <span class="blog-date"><%= post.date %></span>
                                    <h3><%= post.title %></h3>
                                    <p class="blog-excerpt"><%= post.excerpt %></p>
                                    <a href="/blog/<%= post.id %>" class="read-more">
                                        <span>Read More</span>
                                        <i class="ri-arrow-right-line"></i>
                                    </a>
                                </div>
                            </article>
                        <% }) %>
                    <% } else { %>
                        <div style="grid-column: 1/-1; text-align: center; padding: 50px; background: #0a0a0a; border-radius: 20px; border: 1px solid #1a1a1a;">
                            <p style="color: #666;">No articles available at the moment.</p>
                        </div>
                    <% } %>
                </div>
                
                <div class="view-all-container" data-gsap="fade-up">
                    <a href="/blog" class="view-all-btn">View All Articles</a>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="contact-section">
            <div class="container">
                <div class="contact-grid">
                    <div class="contact-info" data-gsap="fade-right">
                        <h2 class="contact-title">Start a New<br>Creative Journey</h2>
                        <p class="contact-subtitle">We are here to listen to your ideas and turn them into an impactful visual strategy. Contact us today.</p>
                        
                        <div class="contact-details">
                            <div class="contact-item">
                                <i class="ri-phone-line"></i>
                                <div>
                                    <span>Call Us</span>
                                    <p dir="ltr">+966 56 839 49 45</p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <i class="ri-mail-line"></i>
                                <div>
                                    <span>Email</span>
                                    <p>info@cpoint-sa.com</p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <i class="ri-map-pin-line"></i>
                                <div>
                                    <span>Location</span>
                                    <p>Riyadh, Saudi Arabia</p>
                                </div>
                            </div>
                        </div>

                        <div class="social-links">
                            <a href="#"><i class="ri-instagram-line"></i></a>
                            <a href="#"><i class="ri-twitter-x-line"></i></a>
                            <a href="#"><i class="ri-linkedin-box-line"></i></a>
                        </div>
                    </div>

                    <div class="contact-form-wrapper" data-gsap="fade-left">
                        <form action="/contact" method="POST" class="contact-form">
                            <div class="form-group">
                                <input type="text" name="name" placeholder="Full Name" required>
                            </div>
                            <div class="form-group">
                                <input type="email" name="email" placeholder="Email Address" required>
                            </div>
                            <div class="form-group">
                                <input type="tel" name="phone" placeholder="Phone Number">
                            </div>
                            <div class="form-group">
                                <select name="service">
                                    <option value="" disabled selected>Select Service</option>
                                    <option value="branding">Branding</option>
                                    <option value="marketing">Digital Marketing</option>
                                    <option value="web">Web Development</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <textarea name="message" rows="5" placeholder="Project Details" required></textarea>
                            </div>
                            <button type="submit" class="submit-btn">
                                <span>Send Request</span>
                                <i class="ri-send-plane-fill"></i>
                            </button>
                        </form>

                        <div id="contact-success" style="display: none; margin-top: 20px; padding: 15px; background: #222; border: 1px solid #fff; border-radius: 10px; color: #fff; text-align: center;">
                            <i class="ri-checkbox-circle-line" style="font-size: 1.5rem; vertical-align: middle; margin-right: 10px;"></i>
                            Your request has been sent successfully! We will contact you soon.
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // Check for success/error query params
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('success')) {
            document.getElementById('contact-success').style.display = 'block';
            const contactForm = document.querySelector('.contact-form');
            if (contactForm) contactForm.style.display = 'none';
        }
    </script>

    <!-- Page Specific Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js" defer></script>
    <script src="/js/hero-animation.js?v=<%= assetVersion %>" defer></script>
    <script src="/js/journey-animation.js?v=<%= assetVersion %>" defer></script>
    <script src="/js/services-animation.js?v=<%= assetVersion %>" defer></script>

    <!-- Slider Config Injection -->
    <script id="slider-config-data" type="application/json">
        <%- JSON.stringify({
            effect: (seo && seo.sliderEffect) ? seo.sliderEffect : "slide",
            autoplay: (seo && seo.sliderAutoplay) ? true : false,
            autoplayDelay: (seo && seo.sliderAutoplayDelay) ? seo.sliderAutoplayDelay : 3000,
            slidesPerView: (seo && seo.sliderSlidesPerView) ? seo.sliderSlidesPerView : 3,
            spaceBetween: (seo && seo.sliderSpaceBetween) ? seo.sliderSpaceBetween : 30
        }) %>
    </script>
    <%- include('partials/footer', { isEn: isEn }) %>
