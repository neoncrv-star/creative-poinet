<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <% 
        // Logic to determine SEO tags
        // Expecting 'seo' object from controller (GlobalSeo instance)
        // Expecting 'pageSeo' object (optional) from controller (Project or Post instance or custom object)
        
        let siteTitle = 'نقطة إبداعية';
        let siteUrl = 'https://deepskyblue-ibis-975175.hostingersite.com';
        let separator = '|';
        let description = 'وكالة إبداعية متخصصة في الحلول الرقمية';
        let keywords = 'تصميم, برمجة, تسويق';
        
        if (typeof seo !== 'undefined' && seo) {
            siteTitle = seo.siteTitle || siteTitle;
            siteUrl = seo.siteUrl || siteUrl;
            separator = seo.titleSeparator || separator;
            description = seo.defaultDescription || description;
            keywords = seo.defaultKeywords || keywords;
        }

        // Ensure siteUrl doesn't have trailing slash for consistency
        if (siteUrl.endsWith('/')) siteUrl = siteUrl.slice(0, -1);

        // Page specific overrides
        let pageTitle = title;
        let pageDescription = description;
        let pageKeywords = keywords;
        let pageImage = null;

        if (typeof pageSeo !== 'undefined' && pageSeo) {
            if (pageSeo.seoTitle) pageTitle = pageSeo.seoTitle;
            else if (pageSeo.title) pageTitle = pageSeo.title; // Fallback to item title

            if (pageSeo.seoDescription) pageDescription = pageSeo.seoDescription;
            else if (pageSeo.excerpt) pageDescription = pageSeo.excerpt; // Fallback to item excerpt/desc
            
            if (pageSeo.seoKeywords) pageKeywords = pageSeo.seoKeywords;

            if (pageSeo.image) pageImage = pageSeo.image;
        }
        
        // Final Title Construction
        let finalTitle = pageTitle;
        if (pageTitle !== siteTitle) {
            finalTitle = `${pageTitle} ${separator} ${siteTitle}`;
        }

        // Prepare Absolute Image URL
        if (pageImage && !pageImage.startsWith('http')) {
            pageImage = siteUrl + (pageImage.startsWith('/') ? '' : '/') + pageImage;
        }
    %>

    <title><%= finalTitle %></title>
    <meta name="description" content="<%= pageDescription %>">
    <meta name="keywords" content="<%= pageKeywords %>">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="<%= finalTitle %>">
    <meta property="og:description" content="<%= pageDescription %>">
    <% if (pageImage) { %>
        <meta property="og:image" content="<%= pageImage %>">
    <% } %>

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="<%= finalTitle %>">
    <meta property="twitter:description" content="<%= pageDescription %>">
    <% if (pageImage) { %>
        <meta property="twitter:image" content="<%= pageImage %>">
    <% } %>

    <link rel="stylesheet" href="/css/style.css">
</head>
<body class="lang-ar"> <!-- Default to Arabic -->
    <header>
        <div class="header-container">
            <div class="logo">
                <a href="/">
                    <h1>
                        <span class="ar">نقطة <span>إبداعية</span></span>
                        <span class="en">Creative <span>Point</span></span>
                    </h1>
                    <p>
                        <span class="ar">وكالة إبداعية</span>
                        <span class="en">Creative Agency</span>
                    </p>
                </a>
            </div>
            <nav>
                <a href="/">
                    <span class="ar">الرئيسية</span>
                    <span class="en">Home</span>
                </a>
                <a href="/portfolio">
                    <span class="ar">أعمالنا</span>
                    <span class="en">Portfolio</span>
                </a>
                <a href="/blog">
                    <span class="ar">المدونة</span>
                    <span class="en">Blog</span>
                </a>
                <!-- Admin link hidden as requested -->
                <button id="lang-toggle" class="btn-lang">English</button>
            </nav>
        </div>
    </header>
    <main>
